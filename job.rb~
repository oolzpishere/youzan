# coding: utf-8
require 'digest/md5'
require 'net/http'
require 'json'
require 'pry'
require_relative 'uri'
require_relative 'out_of_date_sku'
require_relative 'items_arr'
require_relative 'parse_worker'

module Youzan
  class UpdateSku
    attr_reader :json_arr, :uri
    
    def initialize
      @json_arr = Youzan::ParseWorker.new({:api_type => "kdt_items_onsale_get", :base_url => "get"}).run
    end

    def update_sku
      json_arr[0,1].each do |sku|
        #binding.pry
        params = { "num_iid"  => "#{sku["num_iid"]}", "sku_id" =>  "#{sku["sku_id"]}", "quantity" => '11', 'outer_id'=>'654321' }

        run_update({:api_type => "kdt_item_sku_update", :base_url => "update", :params => params})

      end
    end

    def run_update(args)
      uri = Youzan::Uri.new(args).gen_uri
      post = Net::HTTP.post_form(uri, args)
      post.body
    end
    
  end
end

Youzan::UpdateSku.new.update_sku

# api eg. kdt.items.onsale.get = kdt_items_onsale_get

